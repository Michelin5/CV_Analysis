from llm_wrapper import call_giga_api_wrapper

def agent(user_prompt):
    """Агент-координатор: определяет необходимость анализа аномалий и трендов"""
    system_instruction = (
        "Ты — ИИ-координатор запросов. Определи тип анализа, необходимый для запроса пользователя. "
        "Если запрос содержит слова или фразы, связанные с поиском аномалий, выбросов, необычных паттернов, "
        "резких изменений, отклонений от нормы, экстремальных значений, подозрительных данных, "
        "верни JSON: {\"needs_analysis\": \"anomaly\", \"keywords\": [\"найденные ключевые слова\"]}. "
        "Если запрос содержит слова или фразы, связанные с трендами, изменениями во времени, динамикой, "
        "ростом/падением, поворотными точками, переломами тренда, верни JSON: {\"needs_analysis\": \"trend\", \"keywords\": [\"найденные ключевые слова\"]}. "
        "Если запрос содержит оба типа анализа, верни JSON: {\"needs_analysis\": \"both\", \"keywords\": [\"ключевые слова аномалий\", \"ключевые слова трендов\"]}. "
        "Иначе верни JSON: {\"needs_analysis\": \"standard\", \"keywords\": []}. "
        "Ответ должен быть ТОЛЬКО JSON объектом без дополнительного текста."
    )

    response = call_giga_api_wrapper(user_prompt, system_instruction)
    return response

print(agent('Привет братишка как жизнь?'))
